2020-11-24 12:47:41.690881: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
WARNING:tensorflow:From /project/cacds/apps/easybuild/software/Anaconda3/5.0.1/lib/python3.6/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py:4267: IndicatorColumn._variable_shape (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.
Instructions for updating:
The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.
WARNING:tensorflow:From /project/cacds/apps/easybuild/software/Anaconda3/5.0.1/lib/python3.6/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py:4322: VocabularyListCategoricalColumn._num_buckets (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.
Instructions for updating:
The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.
Your runtime has 134.8 gigabytes of available RAM

Current system-wide CPU utilization %:  0.0
2.1.0
(949856, 19)
All target values:
0    792558
1    102409
2     45242
3      7951
4      1696
Name: Prsn_Injry_Sev, dtype: int64
Numerical variables are  ['Prsn_Age', 'Rural', 'Crash_Speed_Limit', 'Veh_Mod_Year', 'Weekend', 'Crash_season', 'Part_of_day']
Categorical variables that have at most 5 categories are  ['Prsn_Gndr', 'Prsn_Drg_Rslt', 'Collsn_type']
Categorical variables that have more than 5 categories are  ['Wthr_Cond', 'Light_Cond', 'Surf_Cond', 'Veh_Body_Styl', 'Prsn_Rest', 'Harm_Evnt', 'Road_Algn', 'Collsn_name']
New shape of the input data set: (949856, 59)
Training features shape: (607907, 59)
Validation features shape: (151977, 59)
Test features shape: (189972, 59)
Counter({0: 507237, 1: 65541, 2: 28954, 3: 5089, 4: 1086})
RUS - ROS
Resampled dataset shape Counter({0: 65541, 1: 65541, 2: 65541, 3: 65541, 4: 65541})
Resamling time 0.25 sec
Restoring model weights from the end of the best epoch.
Epoch 00012: early stopping
             Overall Accuracy    G-mean   Avg_Pfm  Training Time  Resample time
MLP-RUS-ROS           0.47796  0.358981  0.418471        211.673       0.246567
RUS - SMOTE
Resampled dataset shape Counter({0: 65541, 1: 65541, 2: 65541, 3: 65541, 4: 65541})
Resamling time 63.91 sec
Restoring model weights from the end of the best epoch.
Epoch 00027: early stopping
               Overall Accuracy    G-mean   Avg_Pfm  Training Time  Resample time
MLP-RUS-SMOTE           0.48225  0.381684  0.431967         475.87      63.911365
RUS - BorderlineSMOTE
Resampled dataset shape Counter({0: 65541, 1: 65541, 2: 65541, 3: 65541, 4: 65541})
Resamling time 827.81 sec
Restoring model weights from the end of the best epoch.
Epoch 00012: early stopping
                         Overall Accuracy    G-mean   Avg_Pfm  Training Time  Resample time
MLP-RUS-BorderlineSMOTE          0.527172  0.360226  0.443699        211.447     827.809789
NearMiss - ROS
Resampled dataset shape Counter({0: 65541, 1: 65541, 2: 65541, 3: 65541, 4: 65541})
Resamling time 41.86 sec
Restoring model weights from the end of the best epoch.
Epoch 00011: early stopping
                  Overall Accuracy    G-mean   Avg_Pfm  Training Time  Resample time
MLP-NearMiss-ROS          0.297423  0.334893  0.316158        194.191      41.856655
NearMiss - SMOTE
Resampled dataset shape Counter({0: 65541, 1: 65541, 2: 65541, 3: 65541, 4: 65541})
Resamling time 104.88 sec
Restoring model weights from the end of the best epoch.
Epoch 00011: early stopping
                    Overall Accuracy   G-mean   Avg_Pfm  Training Time  Resample time
MLP-NearMiss-SMOTE          0.284184  0.32526  0.304722        193.444      104.88471
NearMiss - BorderlineSMOTE
Resampled dataset shape Counter({0: 65541, 1: 65541, 2: 65541, 3: 65541, 4: 65541})
Resamling time 875.26 sec
Restoring model weights from the end of the best epoch.
Epoch 00011: early stopping
                              Overall Accuracy    G-mean  ...  Training Time  Resample time
MLP-NearMiss-BorderlineSMOTE          0.310935  0.330151  ...        193.555      875.25846

[1 rows x 5 columns]
                              Overall Accuracy    G-mean  ...  Training Time  Resample time
MLP-RUS-ROS                           0.477960  0.358981  ...        211.673       0.246567
MLP-RUS-SMOTE                         0.482250  0.381684  ...        475.870      63.911365
MLP-RUS-BorderlineSMOTE               0.527172  0.360226  ...        211.447     827.809789
MLP-NearMiss-ROS                      0.297423  0.334893  ...        194.191      41.856655
MLP-NearMiss-SMOTE                    0.284184  0.325260  ...        193.444     104.884710
MLP-NearMiss-BorderlineSMOTE          0.310935  0.330151  ...        193.555     875.258460

[6 rows x 5 columns]
